"""
Nechako Watershed Location Terms Database
Extracted from saturation search reference files.
"""

# Location terms organized by category
NECHAKO_LOCATION_TERMS = {
    "lakes": [
        "Angly Lake", "Anzus Lake", "Babine Lake", "Barton Lake", "Bednesti Lake",
        "Bentzi Lake", "Bickle Lake", "Binta Lake", "Bird Lake", "Bittern Lake",
        "Blanchet Lake", "Blanket Lakes", "Bodley Lake", "Bone Lake", "Boomerang Lake",
        "Borel Lake", "Breadalbane Lake", "Brewster Lakes", "Bungalow Lake", "Bunghun Whucho Lake",
        "Burns Lake", "Butterfield Lake", "Cabin Lake", "Cam McEwen Lake", "Capoose Lake",
        "Captain Harry Lake", "Carrier Lake", "Centre Lake", "Chaoborus Lake", "Chelaslie Arm",
        "Cheslatta Lake", "Cheztainya Lake", "Chief Louis Lake", "Chowsunkut Lake", "Cicuta Lake",
        "Circle Lake", "Circum Lake", "Clatlatiently Lake", "Cluculz Lake", "Cobb Lake",
        "Coles Lake", "Copley Lake", "Cory Lake", "Cow Lake", "Crystal Lake",
        "Cunningham Lake", "Dahl Lake", "Dan Miner Lake", "Darby Lake", "Dargie Lake",
        "Davidson Lake", "Dawson Lake", "Decker Lake", "Dem Lake", "Deserter Lake",
        "Dolphin Lake", "Dorman Lake", "Drift Lake", "Drywilliam Lake", "East Hautête Lake",
        "Elalie Lake", "Elliott Lake", "Emmett Lake", "Entiako Lake", "Enz Lake",
        "Euchu Lake", "Euchu Reach", "Eulatazella Lake", "Eutsuk Lake", "Farbus Lake",
        "Fenton Lake", "Finger Lake", "Finnie Lake", "Fish Lake", "Flat Lake",
        "Fleming Lake", "Foster Lakes", "Francois Lake", "Frank Lake", "Fraser Lake",
        "Friday Lake", "Fyfe Lake", "Gale Lake", "Gatcho Lake", "Getzuni Lake",
        "Ghitezli Lake", "Glatheli Lake", "Gluten Lake", "Goodrich Lake", "Goosefoot Lake",
        "Gordon Lake", "Guyishton Lake", "Hallett Lake", "Haney Lake", "Hanson Lake",
        "Harp Lake", "Hat Lake", "Hatdudatehl Lake", "Hautête Lake", "Hay Lake",
        "Hewson Lake", "Hobson Lake", "Hogsback Lake", "Holy Cross Lake", "Home Lake",
        "Horseshoe Lake", "Hoult Lake", "Innes Lake", "Intata Reach", "Inzana Lake",
        "Isaac Lake", "Island Lake", "Jesson Lake", "Johnny Lake", "Johnson Lake",
        "Justine Lake", "Kalder Lake", "Karena Lake", "Kaykay Lake", "Kaza Lake",
        "Kazchek Lake", "Kenney Lake", "Kloch Lake", "Knapp Lake", "Knewstubb Lake",
        "Kuyakuz Lake", "Laidman Lake", "Laurie Lake", "Lavoie Lake", "Lena Lake",
        "Lindquist Lake", "Little Bobtail Lake", "Little Whitesail Lake", "Llgitiyuz Lake", "Long Lake",
        "Looncall Lake", "Lucas Lake", "Lumpy Lake", "Macdougall Lake", "Mackenzie Lake",
        "Majuba Lake", "Malaput Lake", "Margaret Lake", "Marie Lake", "McKelvey Lake",
        "McKnab Lake", "Michel Lake", "Milligan Lake", "Mink Lake", "Mollice Lake",
        "Moose Lake", "Morgan Lake", "Murdoch Lake", "Murray Lake", "Musclow Lake",
        "Nadina Lake", "Nadsilnich Lake", "Nahounli Lake", "Nakinilerak Lake", "Naltesby Lake",
        "Nanitsch Lake", "Nanna Lake", "Natalkuz Lake", "Natazutlo Lake", "Natowite Lake",
        "Needle Lake", "Nendatoo Lake", "Ness Lake", "Newcombe Lake", "Nizik Lake",
        "Norman Lake", "Nulki Lake", "Nutli Lake", "Ocock Lake", "Octopus Lake",
        "Olaf Lake", "Oona Lake", "Ootsa Lake", "Ootsanee Lake", "Ormond Lake",
        "Otterson Lake", "Owl Lake", "Paddle Lake", "Pam Lake", "Parrott Lakes",
        "Peta Lake", "Picket Lake", "Pinchi Lake", "Pondosy Lake", "Redfish Lake",
        "Reid Lake", "Richardson Lake", "Rubyrock Lake", "Sabina Lake", "Sandifer Lake",
        "Sather Lake", "Saxton Lake", "Seel Lake", "Shelford Lake", "Shesta Lake",
        "Short Portage Lake", "Sinkut Lake", "Skinny Lake", "Skins Lake", "Smith Lake",
        "Snowflake Lake", "Spad Lake", "Specularite Lake", "Square Lake", "St. Thomas Lake",
        "Starret Lake", "Stern Lake", "Stuart Lake", "Surel Lake", "Sweeney Lake",
        "Tachick Lake", "Tagai Lake", "Tagetochlain Lake", "Taginchil Lake", "Tahtsa Lake",
        "Tahtsa Reach", "Tahultzu Lake", "Tahuntesko Lake", "Takatoot Lake", "Takla Lake",
        "Takysie Lake", "Targe Lake", "Tarnezell Lake", "Tasa Lake", "Tatalaska Lake",
        "Tatalrose Lake", "Tatelkuz Lake", "Tatin Lake", "Tatsadah Lake", "Tatuk Lake",
        "Tchentlo Lake", "Tchesinkut Lake", "Tercer Lake", "Tesla Lake", "Tetachuck Lake",
        "Tezzeron Lake", "Thletelban Lake", "Thompson Lake", "Tlutlias Lake", "Tochcha Lake",
        "Tomas Lake", "Top Lake", "Trembleur Lake", "Triangle Lake", "Troitsa Lake",
        "Tsayakwacha Lake", "Tschick Lake", "Tsetoyank'ut Lake", "Tsichgass Lake", "Turff Lake",
        "Twinkle Lake", "Uduk Lake", "Uncha Lake", "Wahla Lake", "Wapoose Lake",
        "Webber Lake", "White Eye Lake", "Whitefish Lake", "Whitesail Lake", "Williamson Lake",
        "Willington Lake", "Wutak Lake", "Yatzutzin Lake", "Yellow Moose Lake"
    ],
    
    "rivers": [
        "Aird Creek", "Alf Creek", "Allen Creek", "Allin Creek", "Andrews Creek",
        "Angly Creek", "Ankwill Creek", "Arethusa Creek", "Aslin Creek", "Baker Creek",
        "Banguarel Creek", "Baptiste Creek", "Bates Creek", "Beach Creek", "Bearcub Creek",
        "Beaverdale Creek", "Beaverdam Creek", "Beaverley Creek", "Belisle Creek", "Belzile Creek",
        "Benoit Creek", "Big Bend Creek", "Bird Creek", "Bivouac Creek", "Blackburne Creek",
        "Blackwater River", "Blanchet River", "Bone Creek", "Breadalbane Creek", "Breeze Creek",
        "Brooks Creek", "Bulkley River", "Burnstead Creek", "Butcherflats Creek", "Butterfield Creek",
        "Cabin Creek", "Campbell Creek", "Camsell Creek", "Capoose Creek", "Chedakuz Creek",
        "Chehischic Creek", "Chelaslie River", "Cheskwa Creek", "Cheslatta River", "Chezko River",
        "Chikamin Creek", "Chilako River", "Chilco Creek", "Chillo Creek", "Chinohchey Creek",
        "Chowsunkut Creek", "Clarke Creek", "Clatlatiently Creek", "Clear Creek", "Cluculz Creek",
        "Coles Creek", "Colley Creek", "Comb Creek", "Cordella Creek", "Corkscrew Creek",
        "Cranberry Creek", "Cripple Creek", "Croft Creek", "Cummins Creek", "Cutoff Creek",
        "Dahl Creek", "Dan Miner Creek", "Davidson Creek", "Decker Creek", "Dodd Creek",
        "Dog Creek", "Dorman Creek", "Driftwood River", "Dust Creek", "Eagle Creek",
        "East Erhorn Creek", "East Moxley Creek", "East Murray Creek", "East Negaard Creek", "East Side Creek",
        "Eastern Creek", "Ed Creek", "Eden Creek", "Endako River", "Engen Creek",
        "Engstrom Creek", "Entiako River", "Erhorn Creek", "Esker Creek", "Evans Creek",
        "Fawnie Creek", "Fifteen Creek", "Finger Creek", "Fleming Creek", "Foster Creek",
        "Four Mile Creek", "Fraser River", "Frypan Creek", "Fyfe Creek", "Garvin Creek",
        "Gauvin Creek", "Gerow Creek", "Gesul Buhn Creek", "Gilbert Creek", "Gloyazikut Creek",
        "Goldie Creek", "Goodwin Creek", "Graham Creek", "Gravel Creek", "Greer Creek",
        "Gregg Creek", "Grostete Creek", "Guyishton Creek", "Halsey Creek", "Hatdudatehl Creek",
        "Hautête Creek", "Hawley Creek", "Henkel Creek", "Hogsback Creek", "Hudson Bay Creek",
        "Hulatt Creek", "Hutchison Creek", "Hyman Creek", "Inzana Creek", "Isaac Creek",
        "Jack Weekes Creek", "Janzé Creek", "Kasalka Creek", "Kazchek Creek", "Kec Creek",
        "Kellogg Creek", "Khai Creek", "Kinowsa Creek", "Kivi Creek", "Kleedlee Creek",
        "Klinsake Creek", "Kloch Creek", "Kluk Creek", "Knapp Creek", "Knight Creek",
        "Kuzkwa River", "Lakes Creek", "Laventie Creek", "Lavoie Creek", "Leduc Creek",
        "Leigh Creek", "Leo Creek", "Leona Creek", "Little Bobtail Creek", "Lovell Creek",
        "Lucas Creek", "MacIvor Creek", "Macdougall Creek", "Maclaing Creek", "Maltby Creek",
        "Mandalay Creek", "Marie Creek", "Martens Creek", "Mathews Creek", "McCuish Creek",
        "McDonald Creek", "McIntosh Creek", "McKay Creek", "McKenzie Creek", "McMillan Creek",
        "Michel Creek", "Micks Creek", "Middle River", "Millard Creek", "Moss Creek",
        "Moxley Creek", "Mudhole Creek", "Murray Creek", "Nadina River", "Nahounli Creek",
        "Nancut Creek", "Nankuz Creek", "Natazutlo Creek", "Nautley River", "Nechako River",
        "Necoslie River", "Negaard Creek", "Neuco Creek", "Nielsp Creek", "Nine Mile Creek",
        "Nithi River", "Nizik Creek", "Norman Creek", "North Stony Creek", "O'Ne-ell Creek",
        "Ocock River", "Ohr Creek", "Olie Creek", "Omineca River", "Ormond Creek",
        "Parkland Creek", "Parrott Creek", "Paula Creek", "Peace Creek", "Perry Creek",
        "Peta Creek", "Peter Aleck Creek", "Phillips Creek", "Pinchi Creek", "Pitka Creek",
        "Poplar Creek", "Powder House Creek", "Prairie Meadow Creek", "Preston Creek", "Puttah Creek",
        "Ramsay Creek", "Redmond Creek", "Relief Creek", "Rentoul Creek", "Rhine Creek",
        "Robertson Creek", "Rubyrock Creek", "Sakeniche River", "Sam Ross Creek", "Sandifer Creek",
        "Sauls Creek", "Saxton Creek", "Schjelderup Creek", "Shelford Creek", "Sheraton Creek",
        "Shillestead Brook", "Short Creek", "Shotgun Creek", "Shovel Creek", "Sibola Creek",
        "Sidney Creek", "Sinkut River", "Sinta Creek", "Sitlika Creek", "Small Trout Creek",
        "Smith Creek", "Snodgrass Creek", "Sob Creek", "South Creek", "South Goldie Creek",
        "Sowchea Creek", "Specularite Creek", "Spencha Creek", "St. George Creek", "St. Thomas River",
        "Stearns Creek", "Stellako River", "Stern Creek", "Stony Creek", "Stuart River",
        "Swanson Creek", "Sweden Creek", "Sweetnam Creek", "Tachick Creek", "Tachie River",
        "Tachintelachick Creek", "Tagetochlain Creek", "Taginchil Creek", "Tahultzu Creek", "Takatoot Creek",
        "Takysie Creek", "Targe Creek", "Tarnezell Creek", "Taslincheko Creek", "Tatalaska Creek",
        "Tatalrose Creek", "Tatin Creek", "Tatsutnai Creek", "Tatuk Creek", "Tchesinkut Creek",
        "Tesla Creek", "Tetachuck River", "Tezzeron Creek", "Tibbets Creek", "Tildesley Creek",
        "Tintagel Creek", "Tliti Creek", "Tlutlias Creek", "Totem Pole Creek", "Trankle Creek",
        "Tritt Creek", "Troitsa Creek", "Tsah Creek", "Tsilcoh River", "Tsitsutl Creek",
        "Tultsau Creek", "Ucausley Creek", "Uncha Creek", "Upper Moss Creek", "Van Decar Creek",
        "Van Lear Creek", "Van Tine Creek", "Wardrop Creek", "Webber Creek", "Wells Creek",
        "West Engen Creek", "West Tarnezell Creek", "Whitefish Creek", "Whiting Creek", "Wilhelmsen Creek",
        "Willowy Creek", "Wynkes Creek", "Zelkwas Creek"
    ],
    
    "communities": [
        "Carrier", "Dakelh", "Nadleh Whuten", "Nak'azdli", 
        "Saik'uz", "Skin Tyee", "Tl'azt'en", "Wet'suwet'en"
    ],
    
    "cities": [
        "Bulkley House", "Clemretta", "Colleymount", "Danskin", "Endako",
        "Fort Fraser", "Fort St. James", "Granisle", "Grassy Plains", "Houston",
        "Isle Pierre", "Mapes", "Marilla", "McDonalds Landing", "Miworth",
        "Mud River", "Nautley", "Noralee", "Nulki", "Pinchi",
        "Prince George", "Punchaw", "Shady Valley", "Smithers", "Southbank",
        "Sowchea 3", "Stellako", "Sunnyside", "Tachie", "Takla Landing",
        "Tatalrose", "Tatla't East", "Telachick", "Tintagel", "Topley",
        "Vanderhoof", "Weneez", "Wet'suwet'en Village", "Wistaria", "Woyenne"
    ]
}

# Major water bodies for priority matching
MAJOR_WATER_BODIES = {
    "primary_lakes": [
        "Takla Lake", "Ootsa Lake", "Stuart Lake", "Francois Lake", 
        "Fraser Lake", "Babine Lake", "Burns Lake", "Pinchi Lake",
        "Cheslatta Lake", "Knewstubb Lake"
    ],
    "primary_rivers": [
        "Nechako River", "Stuart River", "Endako River", "Stellako River",
        "Nautley River", "Nadina River", "Cheslatta River", "Fraser River"
    ]
}

# Key communities for enhanced matching
KEY_COMMUNITIES = {
    "major_cities": [
        "Fort St. James", "Vanderhoof", "Burns Lake", 
        "Fraser Lake", "Prince George"
    ],
    "first_nations": [
        "Tl'azt'en", "Nak'azdli", "Saik'uz", "Wet'suwet'en", "Carrier"
    ]
}

def get_all_location_terms():
    """
    Return all location terms as a flat list.
    """
    all_terms = []
    for category, terms in NECHAKO_LOCATION_TERMS.items():
        all_terms.extend(terms)
    return all_terms

def get_location_terms_by_category(category):
    """
    Get location terms for a specific category.
    
    Args:
        category (str): One of 'lakes', 'rivers', 'communities', 'cities'
    
    Returns:
        list: Location terms for the specified category
    """
    return NECHAKO_LOCATION_TERMS.get(category, [])

def build_location_query():
    """
    Build a boolean query string for use in database searches.
    
    Returns:
        str: Boolean query with all location terms OR'd together
    """
    all_terms = get_all_location_terms()
    quoted_terms = [f'"{term}"' for term in all_terms]
    return " OR ".join(quoted_terms)

def build_priority_location_query():
    """
    Build a boolean query focusing on major water bodies and communities.
    
    Returns:
        str: Boolean query with priority location terms
    """
    priority_terms = []
    priority_terms.extend(MAJOR_WATER_BODIES["primary_lakes"])
    priority_terms.extend(MAJOR_WATER_BODIES["primary_rivers"])
    priority_terms.extend(KEY_COMMUNITIES["major_cities"])
    priority_terms.extend(KEY_COMMUNITIES["first_nations"])
    
    quoted_terms = [f'"{term}"' for term in priority_terms]
    return " OR ".join(quoted_terms)

def count_location_matches(text):
    """
    Count how many location terms appear in a given text.
    
    Args:
        text (str): Text to search for location terms
        
    Returns:
        dict: Count of matches by category and total
    """
    text_lower = text.lower()
    matches = {
        'lakes': 0,
        'rivers': 0,
        'communities': 0,
        'cities': 0,
        'total': 0
    }
    
    for category, terms in NECHAKO_LOCATION_TERMS.items():
        for term in terms:
            if term.lower() in text_lower:
                matches[category] += 1
                matches['total'] += 1
    
    return matches

def is_nechako_relevant(text):
    """
    Determine if text is relevant to Nechako Watershed based on location terms.
    
    Args:
        text (str): Text to analyze
        
    Returns:
        tuple: (is_relevant: bool, confidence_score: float, matches: dict)
    """
    matches = count_location_matches(text)
    
    # Calculate confidence score
    confidence_score = 0.0
    if matches['total'] > 0:
        # Base score for any matches
        confidence_score = 0.3
        
        # Bonus for multiple matches
        confidence_score += min(matches['total'] * 0.1, 0.4)
        
        # Extra bonus for major water bodies
        for term in MAJOR_WATER_BODIES["primary_lakes"] + MAJOR_WATER_BODIES["primary_rivers"]:
            if term.lower() in text.lower():
                confidence_score += 0.2
                break
        
        # Cap at 1.0
        confidence_score = min(confidence_score, 1.0)
    
    is_relevant = confidence_score >= 0.3
    
    return is_relevant, confidence_score, matches